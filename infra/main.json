{
  "type": "Microsoft.Web/sites",
  "apiVersion": "2023-01-01",
  "name": "[parameters('functionAppName')]",
  "location": "[parameters('location')]",
  "kind": "functionapp,linux",
  "identity": { "type": "SystemAssigned" },
  "properties": {
    "serverFarmId": "[resourceId('Microsoft.Web/serverfarms', parameters('appServicePlanName'))]",
    "httpsOnly": true
  },
  "functionAppConfig": {
    "deployment": {
      "packageUrl": "https://cloudnetdrawappstorage.blob.core.windows.net/cloudnetdrawapp/function.zip"
    },
    "runtime": {
      "name": "python",
      "version": "3.10"
    },
    "appSettings": [
      {
        "name": "AzureWebJobsStorage",
        "value": "[format('DefaultEndpointsProtocol=https;AccountName={0};AccountKey={1};EndpointSuffix={2}', parameters('storageAccountName'), listKeys(resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName')), '2022-09-01').keys[0].value, environment().suffixes.storage)]"
      },
      {
        "name": "DRAWING_CONTAINER_NAME",
        "value": "[parameters('containerName')]"
      }
    ],
    "scaleAndConcurrency": {
      "maximumInstanceCount": 100,
      "instanceMemoryMB": 2048
    }
  },
  "dependsOn": [
    "[resourceId('Microsoft.Web/serverfarms', parameters('appServicePlanName'))]",
    "[resourceId('Microsoft.Storage/storageAccounts', parameters('storageAccountName'))]"
  ]
}
